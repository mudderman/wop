function convertTo24h(e){var r=Number(e.match(/^(\d+)/)[1]),t=Number(e.match(/:(\d+)/)[1]),n=e.match(/(am|pm)$/)[1];"pm"==n&&r<12&&(r+=12),"am"==n&&12==r&&(r-=12);var a=r.toString(),o=t.toString();return r<10&&(a="0"+a),t<10&&(o="0"+o),a+":"+o}function currency(e){return e in currencyMap?currencyMap[e]:"SEK"!==e?" "+e:""}var url='http://query.yahooapis.com/v1/public/yql?q=select * from yahoo.finance.quotes where symbol IN ("'+message.suffix+'")&format=json&env=http://datatables.org/alltables.env',currencyMap={USD:"$",GBP:"£"};unirest.get(url).headers({Accept:"application/json","User-Agent":"Mozilla/5.0 (Linux; Android 6.0.1; MotoG3 Build/MPI24.107-55) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/51.0.2704.81 Mobile Safari/537.36"}).end(function(e){if(200==e.status&&1==e.body.query.count&&e.body.query.results.quote&&null!=e.body.query.results.quote.Ask){var r=e.body.query.results.quote,t="Aktie: "+r.Symbol+" / Kurs "+r.LastTradePriceOnly+currency(r.Currency)+" / Idag "+r.Change+currency(r.Currency)+" "+r.ChangeinPercent;t+="\nHögsta: "+r.DaysHigh+currency(r.Currency)+" / Lägsta: "+r.DaysLow+currency(r.Currency),t+="\nSenaste avslut: "+convertTo24h(r.LastTradeTime),t+="\nhttp://finance.yahoo.com/quote/"+message.suffix,ch.sendMessage(t)}else ch.sendMessage("Sorry, I can't find that stock symbol.")});
